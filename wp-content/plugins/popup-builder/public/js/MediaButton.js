function SGPBMediaButton(){}SGPBMediaButton.prototype.init=function(){this.openMediaButtonPopup()},SGPBMediaButton.prototype.openMediaButtonPopup=function(){var i=this,s=1;jQuery(".sgpb-insert-media-button-js, .sgpb-insert-js-variable").bind("click",function(e){e.preventDefault();var t=jQuery(this).attr("data-id"),o=new PopupConfig;o.magicCall("setContentPadding",14),o.magicCall("setContentBorderRadius",4),o.magicCall("setContentBorderRadiusType","px"),o.magicCall("setContentBorderWidth",5),o.magicCall("setContentBorderColor","#506274"),o.magicCall("setShadowSpread",1),o.magicCall("setContentShadowBlur",4),o.magicCall("setContentShadowColor","#cccccc"),o.magicCall("setMinWidth",400),o.magicCall("setSrcElement",t),o.magicCall("setOverlayColor","black"),o.magicCall("setOverlayOpacity",40);var n=o.combineConfigObj(),a=new SGPopup(n);a.open(),jQuery(window).bind("sgpbDidOpen",function(){jQuery(".sgpb-insert-popup").addClass("js-sg-select2"),mediaButtonParams.currentPostType!=mediaButtonParams.popupBuilderPostType?(jQuery(".sgpb-insert-popup-event").addClass("js-sg-select2"),1==s&&i.popupSelect2(),s++,console.log(jQuery(".select2-container--below").length),jQuery(".select2-container--below").remove(),i.popupSelect2()):(i.popupSelect2(),jQuery(".select2-container--below").remove()),i.closeMediaButtonPopup(a)}),i.insertPopup(a)})},SGPBMediaButton.prototype.closeMediaButtonPopup=function(e){jQuery(".sgpb-close-media-popup-js").on("click",function(){e.close()})},SGPBMediaButton.prototype.insertPopup=function(s){var r=!1;mediaButtonParams.currentPostType==mediaButtonParams.popupBuilderPostType&&(r=!0),jQuery(".sgpb-insert-popup-js").bind("click",function(){var e=jQuery(".sgpb-insert-popup").val(),t=jQuery(".sgpb-insert-popup-event").val();if(void 0!==t?t=' event="'+t+'"':(t="",r&&(t=' insidePopup="on"')),""!=e&&null!=e){if("onLoad"==t&&!r)return window.send_to_editor('[sg_popup id="'+e+'"'+t+"][/sg_popup]"),void s.close();if(void 0!==tinyMCE.editors.content&&null===document.getElementById("content").offsetParent)o=tinyMCE.activeEditor.selection.getContent()?tinyMCE.activeEditor.selection.getContent():"";else{var o,n=document.getElementById("content");if(void 0!==document.selection)n.focus(),o=document.selection.createRange().text;else if(void 0!==n.selectionStart){var a=n.selectionStart,i=n.selectionEnd;o=n.value.substring(a,i)}}window.send_to_editor('[sg_popup id="'+e+'"'+t+"]"+o+"[/sg_popup]"),s.close()}else s.close()}),jQuery(".sgpb-insert-js-variable-to-editor").bind("click",function(){var e=jQuery(".sgpb-js-variable-selector").val(),t=jQuery(".sgpb-js-variable-attribute").val();jQuery(".sgpb-js-variable-errors").addClass("sg-hide-element");var o=!0;if(""==e&&(o=!1,jQuery(".sgpb-js-variable-selector-error").removeClass("sg-hide-element")),""==t&&(o=!1,jQuery(".sgpb-js-variable-attribute-error").removeClass("sg-hide-element")),!o)return!1;jQuery(".sgpb-js-variable-errors").addClass("sg-hide-element"),window.send_to_editor('[pbvariable selector="'+e+'" attribute="'+t+'"]'),s.close()})},SGPBMediaButton.prototype.popupSelect2=function(){jQuery(".js-sg-select2").length&&jQuery("select.js-sg-select2").each(function(){var e=jQuery(this).attr("data-select-type"),t=(jQuery(this).attr("data-select-class"),{width:"100%"});"ajax"==e&&(t=jQuery.extend(t,{minimumInputLength:1,ajax:{url:SGPB_JS_PARAMS.url,dataType:"json",delay:250,type:"POST",data:function(e){var t=jQuery(this).attr("data-value-param");return{action:"select2_search_data",nonce_ajax:SGPB_JS_PARAMS.nonce,searchTerm:e.term,searchKey:t}},processResults:function(e){return{results:jQuery.map(e.items,function(e){return{text:e.text,id:e.id}})}}}})),jQuery(this).sgpbselect2(t)})},jQuery(document).ready(function(){(new SGPBMediaButton).init()});
